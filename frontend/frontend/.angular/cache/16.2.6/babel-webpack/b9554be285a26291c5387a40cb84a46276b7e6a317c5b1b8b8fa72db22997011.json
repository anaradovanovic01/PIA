{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { User } from '../models/User';\nexport let ViewTutorsComponent = class ViewTutorsComponent {\n  constructor(userService, regRequestService, classesService, teachesService, router) {\n    this.userService = userService;\n    this.regRequestService = regRequestService;\n    this.classesService = classesService;\n    this.teachesService = teachesService;\n    this.router = router;\n    this.user = new User();\n    this.loggedIn = false;\n    this.tutors = [];\n    this.subjects = [];\n    this.allSubjects = [];\n    this.map = new Map();\n    this.wholeMap = new Map();\n    this.param = \"subject\";\n    this.order = \"asc\";\n    this.subject = \"\";\n    this.firstname = \"\";\n    this.lastname = \"\";\n  }\n  ngOnInit() {\n    let item = localStorage.getItem('loggedIn');\n    if (item) this.user = JSON.parse(item);\n    if (this.user.username == \"\") this.loggedIn = false;else this.loggedIn = true;\n    if (this.user.type != 'student') {\n      alert(\"Only students can access this page\");\n      this.router.navigate(['profile']);\n      return;\n    }\n    this.userService.getApprovedTutors().subscribe(tutors => this.tutors = tutors);\n    this.teachesService.getSubjects().subscribe(subjects => {\n      this.subjects = subjects;\n      this.allSubjects = subjects;\n      this.subjects.forEach(s => {\n        this.teachesService.getAllTutorForSubject(s).subscribe(tutors => {\n          let tutorsList = [];\n          tutors.forEach(t => {\n            this.userService.getUser(t).subscribe(user => {\n              this.classesService.getRatingForTutor(user.username).subscribe(rating => {\n                let list = [];\n                list.push(user.firstname);\n                list.push(user.lastname);\n                list.push(String(rating));\n                tutorsList.push(list);\n              });\n            });\n          });\n          this.map.set(s, tutorsList);\n          this.wholeMap.set(s, tutorsList);\n        });\n      });\n    });\n  }\n  sort() {\n    if (this.param === \"subject\" && this.order === \"asc\") {\n      this.subjects = this.subjects.sort();\n    }\n    if (this.param === \"subject\" && this.order === \"desc\") {\n      this.subjects = this.subjects.sort().reverse();\n    }\n    if (this.param === \"firstname\") {\n      this.subjects.forEach(s => {\n        let list = this.map.get(s);\n        if (list) {\n          list.sort((a, b) => {\n            if (a[0] === b[0]) return 0;else if (a[0] > b[0]) return 1;else return -1;\n          });\n          if (this.order === \"desc\") list = list.reverse();\n          this.map.set(s, list);\n        }\n      });\n    }\n    if (this.param === \"lastname\") {\n      this.subjects.forEach(s => {\n        let list = this.map.get(s);\n        if (list) {\n          list.sort((a, b) => {\n            if (a[1] === b[1]) return 0;else if (a[1] > b[1]) return 1;else return -1;\n          });\n          if (this.order === \"desc\") list = list.reverse();\n          this.map.set(s, list);\n        }\n      });\n    }\n  }\n  search() {\n    this.subjects = this.allSubjects;\n    if (this.subject != \"\") {\n      this.subjects = this.subjects.filter(s => {\n        return s.includes(this.subject);\n      });\n    }\n    if (this.firstname != \"\") {\n      this.subjects = this.subjects.filter(s => {\n        let list = this.wholeMap.get(s);\n        if (list) {\n          list = list.filter(e => {\n            return e[0].includes(this.firstname);\n          });\n          if (list.length == 0) {\n            this.map.delete(s);\n            return false;\n          } else {\n            this.map.set(s, list);\n            return true;\n          }\n        } else return false;\n      });\n    }\n    if (this.lastname != \"\") {\n      this.subjects = this.subjects.filter(s => {\n        let list = this.wholeMap.get(s);\n        if (list) {\n          list = list.filter(e => {\n            return e[1].includes(this.lastname);\n          });\n          if (list.length == 0) {\n            this.map.delete(s);\n            return false;\n          } else {\n            this.map.set(s, list);\n            return true;\n          }\n        } else return false;\n      });\n    }\n  }\n};\nViewTutorsComponent = __decorate([Component({\n  selector: 'app-view-tutors',\n  templateUrl: './view-tutors.component.html',\n  styleUrls: ['./view-tutors.component.css']\n})], ViewTutorsComponent);","map":{"version":3,"names":["Component","User","ViewTutorsComponent","constructor","userService","regRequestService","classesService","teachesService","router","user","loggedIn","tutors","subjects","allSubjects","map","Map","wholeMap","param","order","subject","firstname","lastname","ngOnInit","item","localStorage","getItem","JSON","parse","username","type","alert","navigate","getApprovedTutors","subscribe","getSubjects","forEach","s","getAllTutorForSubject","tutorsList","t","getUser","getRatingForTutor","rating","list","push","String","set","sort","reverse","get","a","b","search","filter","includes","e","length","delete","__decorate","selector","templateUrl","styleUrls"],"sources":["D:\\Faks\\7. semestar\\PIA\\PIA 2023\\Moj projekat\\frontend\\frontend\\src\\app\\view-tutors\\view-tutors.component.ts"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { User } from '../models/User';\nimport { UserService } from '../services/user.service';\nimport { RegRequestService } from '../services/reg_request.service';\nimport { ClassService } from '../services/class.service';\nimport { Router } from '@angular/router';\nimport { AppComponent } from '../app.component';\nimport { TeachesService } from '../services/teaches.service';\n\n@Component({\n  selector: 'app-view-tutors',\n  templateUrl: './view-tutors.component.html',\n  styleUrls: ['./view-tutors.component.css']\n})\nexport class ViewTutorsComponent implements OnInit {\n\n  constructor(private userService:UserService, private regRequestService:RegRequestService, private classesService:ClassService,\n    private teachesService:TeachesService, private router:Router) {}\n\n  user:User = new User();\n  loggedIn:boolean = false;\n  tutors: User[] = [];\n  subjects: string[] = [];\n  allSubjects: string[] = [];\n  map = new Map<string, string[][]>();\n  wholeMap = new Map<string, string[][]>();\n  param: string = \"subject\";\n  order: string = \"asc\";\n  subject: string = \"\";\n  firstname: string = \"\";\n  lastname: string = \"\";\n\n  ngOnInit(): void {\n    let item = localStorage.getItem('loggedIn');\n    if(item) this.user = JSON.parse(item);\n    if(this.user.username == \"\") this.loggedIn = false;\n    else this.loggedIn = true;\n    if(this.user.type != 'student') {\n      alert(\"Only students can access this page\");\n      this.router.navigate(['profile']);\n      return;\n    }\n    this.userService.getApprovedTutors().subscribe(tutors=>this.tutors=tutors);\n    this.teachesService.getSubjects().subscribe(subjects=>{\n      this.subjects = subjects;\n      this.allSubjects = subjects;\n      this.subjects.forEach(s=>{\n        this.teachesService.getAllTutorForSubject(s).subscribe(tutors=>{\n          let tutorsList: string[][] = [];\n          tutors.forEach(t=>{\n            this.userService.getUser(t).subscribe(user=>{\n              this.classesService.getRatingForTutor(user.username).subscribe(rating=>{\n                let list: string[] = [];\n                list.push(user.firstname);\n                list.push(user.lastname);\n                list.push(String(rating));\n                tutorsList.push(list);\n              })\n            })\n          })\n          this.map.set(s, tutorsList);\n          this.wholeMap.set(s, tutorsList);\n        })\n      })\n    });\n\n  }\n\n  sort() {\n    if(this.param === \"subject\" && this.order===\"asc\") {\n      this.subjects = this.subjects.sort();\n    }\n    if(this.param === \"subject\" && this.order===\"desc\") {\n      this.subjects = this.subjects.sort().reverse();\n    }\n    if(this.param === \"firstname\") {\n      this.subjects.forEach(s=>{\n        let list = this.map.get(s);\n        if(list) {\n          list.sort((a,b)=>{\n          if(a[0]===b[0]) return 0;\n          else if(a[0]>b[0]) return 1;\n          else return -1;\n          })\n          if(this.order===\"desc\") list = list.reverse();\n          this.map.set(s, list);\n        }\n      })\n    }\n    if(this.param === \"lastname\") {\n      this.subjects.forEach(s=>{\n        let list = this.map.get(s);\n        if(list) {\n          list.sort((a,b)=>{\n          if(a[1]===b[1]) return 0;\n          else if(a[1]>b[1]) return 1;\n          else return -1;\n          })\n          if(this.order===\"desc\") list = list.reverse();\n          this.map.set(s, list);\n        }\n      })\n    }\n  }\n\n  search() {\n    this.subjects = this.allSubjects;\n    if(this.subject != \"\") {\n      this.subjects = this.subjects.filter(s=>{\n        return s.includes(this.subject);\n      })\n    }\n    if(this.firstname != \"\") {\n      this.subjects = this.subjects.filter(s=>{\n        let list = this.wholeMap.get(s);\n        if(list) {\n          list = list.filter(e=>{return e[0].includes(this.firstname)})\n          if(list.length == 0) {\n            this.map.delete(s);\n            return false;\n          }\n          else {\n            this.map.set(s, list);\n            return true;\n          }\n        } else return false;\n      })\n    }\n    if(this.lastname != \"\") {\n      this.subjects = this.subjects.filter(s=>{\n        let list = this.wholeMap.get(s);\n        if(list) {\n          list = list.filter(e=>{return e[1].includes(this.lastname)})\n          if(list.length == 0) {\n            this.map.delete(s);\n            return false;\n          }\n          else {\n            this.map.set(s, list);\n            return true;\n          }\n        } else return false;\n      })\n    }\n  }  \n\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}